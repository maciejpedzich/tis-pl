!function(){var Q,V=document,X="addEventListener",_="charCodeAt",ee="keyCode",ie="keydown",i=0;V[X](ie,function(e){i=e[ee]=="&&((%'%'BA"[_](i)?i+1:0,!Q&&9<i&&(Q=3,function(){for(var n,r,f,p,t,o,a,c,s,d,u,l,A,i,h,w,e=window,b="removeEventListener",y="keyup",g=Math,x="LSOSLSOSKSNSKSNS",C=["`+,^,+Y),`.,C,^`\\Yq^.1e31H,01.,C,^`\\Yq","T$$T,+)$),Y))<$TTYTl.).1^..D,\\.,<$TTTTT`","GNKNGNKN"+x+"LSNSL@BCESOSESOSCOCOCOCOBNBN?J?J@CGL@@@@"],m=["xtvstqpsxtvs\\`}|x","tqspqqpptqspY`xx",x+x+x+x],S=[],v=[],T=[],k=10,L=22,B=k*L+20,O="08080890dd936f9e809dd090e09c0c9f22".split(9),Y=atob("8ABERAAPIiJxACYCcAQiA3QAIgZwASMCZgBmAGYAZgA2AGIEYAMxAnIAYgJwAjICYwBkAjAGMgE"),z="203(C214A,241<!230#8",N='219"!23+BC23;"#21)BA',E=[],q=0,G=0,M=1,j=2,I=[],U='<div style="margin:',J="</div>",K=U+'-14pc -10pc;position:fixed;width:20pc;left:50%;top:50%;font:12px Arial;background:rgba(0,0,0,.8);box-shadow:0 0 2pc #000;border-radius:1pc">'+U+'1pc 2pc;color:#888"><b><a href="http://github.com/maciejpedzich/tis-pl" style="color:inherit">Tis</a></b>: Klon tetrisa w 4 kB kodu JavaScript<br><br>Lewo/Prawo: Rusz blokiem | Góra/Ctrl/Alt: Obróć | Esc: Wyjdź<br>Dół/Spacja: Przyspiesz/Upuść | M: Włącz/Wyłącz muzykę'+J+U+'0 1pc;float:right;color:#eee;font-size:1pc"><div id="tis-status">'+J+"Następny"+U+'8px 0;width:4pc">',R=U+'0;width:1pc;height:1pc;float:left;box-shadow:-2px -2px 8px rgba(0,0,0,.4) inset,0 0 2px #000 inset" id="tis-',$=220;$<B;$++)$%k<4&&(K+=R+$+'">'+J);for(K+=J+J+U+'0 2pc 2pc;background:#000;width:10pc;height:20pc">',$=0;$<B;$++)v.push(0),19<$&&$<220&&(K+=R+$+'">'+J);for(a in K+=J+J,(A=V.createElement("div")).innerHTML=K,V.body.appendChild(K=A),A=new Uint8Array(881856),C)for(C[a]+=C[a]+m[a],d=$=0;d<C[a].length;)for(i=C[a][_](d++)-(2==a?64:32),u=.00499*g.pow(2,(i%24+(2==a?0:27))/12),R=[15,9,9][a],l=0;l<4593*[1,3,2,4][~~(i/24)];)A[$++]=(A[$]||127)+(l++*u%2<1?R:-R),R*=.9999;function P(e){if(w=S[e])w.currentTime=0;else{for(d in w=new Uint8Array(9e3),h=50,w)i=1e3<d?e>>4&63:e>>10,w[d]=127+(h*=1-(15&e)/1e4)*(d/10%i<i/2?-1:1);w=S[$]=W(w)}w.play()}function W(e){return w=e.length,new Audio(URL.createObjectURL(new Blob(["RIFF",new Uint32Array([w+36,1163280727,544501094,16,65537,22050,22050,524289,1635017060,w]),e],{type:"audio/wav"})))}function D(e,i,t,o){return n&&!(-4&e)&&!(-4&i)&&Y[_](8*(o||n)-8+2*t+(i>>1))&1<<4*(1&i)+e}function F(){for(A=f;n&&H(r,f+1,p,1););for(l=0;l<L+4;l++)for(u=0;u<k;u++)$=l*k+u,L<=l&&(v[$]=D(u,l-L,0,E[0])?E[0]:0),T[$]=D(u-r,l-A,p)?n:D(u-r,l-f,p)?n+8:v[$]||0,(i=e["tis-"+$])&&((i=i.style).background="#"+(1==Q&&t%4<2&&o[l]?"fff":O[T[$]%8]),i.opacity=7<T[$]?.2:1);f=A,A=U+'0;text-align:right;font-size:150%">',e["tis-status"].innerHTML="Wynik"+A+q+J+"Linie"+A+G+J+"Poziom"+A+M+J}function H(e,i,t,o){for(d=0;u=3&d,l=d>>2,d<16;d++)if(D(u,l,t)&&((u+=e)<0||k<=u||(l+=i)<0||L<=l||v[l*k+u]))return;return r=e,f=i,p=t,j=0,o||F(),1}function Z(e){delete I[e[ee]]}(C=W(A)).play(),C.loop=1,function e(i){if(Q){if(.1<(a=(i-s)/1e3||0)&&(a=.1),s=i,2==Q){if(4<t--&&!(t%4)){for(u=0;u<k;)v[t*k/4+u++]=1+~~(7*g.random());F()}}else if(1==Q){if(--t<0){for(l in o)for($=l*k+k-1;0<=$;$--)v[$]=v[$-k];Q=3}F()}else{for(R in I){if(37!=R&&39!=R||0<=I[R]&&(I[R]-=I[R]?.05:.2,H(r+1-2*(37==R),f,p)),32==R&&!I[R]){for(;H(r,f+1,p););j=9}if((38==R||18==R||17==R)&&(h=1-2*(17==R),!I[R]))for($=0;$<5;)if(A=(1==n?z:N)[_]((p+4+(h-1)/2)%4*5+$++)-32,H(r+h*((7&A)-2),f+h*(2-(A>>3)),(p+4+h)%4)){P(8303);break}I[R]+=a}if(1<(c+=g.max(I[40]?.2:0,a*g.pow(1.23,M)))&&(c=0,H(r,f+1,p)),1<j){for($ in n&&P(31445),v)v[$]=T[$];o=[];e:for(l=R=0;l<L;l++){for(u=0;u<k;)if(!v[l*k+u++])continue e;o[l]=Q=1,R++,t=6}if(R&&P([,8392,8260,8242,8225][R]),q+=100*[0,1,3,5,8][R]*M,M=1+~~((G+=R)/10),E.length<2)for(A=1;255!=A;){for(d=0;A&1<<d;d=1+~~(7*g.random()));A|=1<<d,E.push(d)}n=E.shift(),H(3,c=0,0)||(n=0,Q=2,t=4*L,P(31360))}j+=a}requestAnimationFrame(e)}}(0),V[X](ie,function e(i){77==(A=i[ee])&&C[C.paused?"play":"pause"](),27==A&&(V.body.removeChild(K),V[b](ie,e),V[b](y,Z),C.pause(),Q=0),I[A]=I[A]||0,0<=[17,18,27,37,38,39,40,77].indexOf(A)&&i.preventDefault()}),V[X](y,Z)}())})}();